var _canLog=!0;function _log(d,p){if(_canLog){var m=Array.prototype.slice.apply(arguments,[1]),q=new Date,q=q.getHours()+":"+q.getMinutes()+":"+q.getSeconds()+"."+q.getMilliseconds();m[0]=q+" - "+m[0];try{switch(d){case "info":window.console.info.apply(window.console,m);break;case "warn":window.console.warn.apply(window.console,m);break;default:window.console.log.apply(window.console,m)}}catch(r){window.console?-2146827850===r.number&&window.console.log(m.join(", ")):_canLog=!1}}}
function _checkBrowser(){var d,p,m;d=navigator.userAgent;d=d.toLowerCase();p=/(chrome)[ \/]([\w.]+)/.exec(d)||/(webkit)[ \/]([\w.]+)/.exec(d)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(d)||/(msie) ([\w.]+)/.exec(d)||0>d.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(d)||[];d=p[1]||"";p=p[2]||"0";m={};d&&(m[d]=!0,m.version=p);m.chrome?m.webkit=!0:m.webkit&&(m.safari=!0);return m}var BROWSER=jQuery.browser||_checkBrowser();
function logMsg(d){Array.prototype.unshift.apply(arguments,["debug"]);_log.apply(this,arguments)}var getDynaTreePersistData=null,DTNodeStatus_Error=-1,DTNodeStatus_Loading=1,DTNodeStatus_Ok=0;
(function(d){function p(a,b){var c=(""+a).split("."),e=(""+b).split("."),f=Math.min(c.length,e.length),g,d,k;for(k=0;k<f;k++)if(g=parseInt(c[k],10),d=parseInt(e[k],10),isNaN(g)&&(g=c[k]),isNaN(d)&&(d=e[k]),g!=d)return g>d?1:g<d?-1:NaN;return c.length===e.length?0:c.length<e.length?-1:1}function m(a){var b=a.options.dnd||null;b&&(b.onDragStart||b.onDrop)&&v();b&&b.onDragStart&&a.$tree.draggable({addClasses:!1,appendTo:"body",containment:!1,delay:0,distance:4,revert:!1,scroll:!0,scrollSpeed:7,scrollSensitivity:10,
connectToDynatree:!0,helper:function(a){var b=d.ui.dynatree.getNode(a.target);return b?b.tree._onDragEvent("helper",b,null,a,null,null):"<div></div>"},start:function(a,b){return!!b.helper.data("dtSourceNode")},_last:null});b&&b.onDrop&&a.$tree.droppable({addClasses:!1,tolerance:"intersect",greedy:!1,_last:null})}var q={create:function(){return function(){this.initialize.apply(this,arguments)}}},r=q.create();r.prototype={initialize:function(a,b,c){this.parent=a;this.tree=b;"string"===typeof c&&(c=
{title:c});c.key=c.key?""+c.key:"_"+b._nodeCount++;this.data=d.extend({},d.ui.dynatree.nodedatadefaults,c);this.childList=this.ul=this.span=this.li=null;this.bSelected=this.bExpanded=this.hasSubSel=this._isLoading=!1},toString:function(){return"DynaTreeNode<"+this.data.key+">: '"+this.data.title+"'"},toDict:function(a,b){var c=d.extend({},this.data);c.activate=this.tree.activeNode===this;c.focus=this.tree.focusNode===this;c.expand=this.bExpanded;c.select=this.bSelected;b&&b(c);if(a&&this.childList){c.children=
[];for(var e=0,f=this.childList.length;e<f;e++)c.children.push(this.childList[e].toDict(!0,b))}else delete c.children;return c},fromDict:function(a){var b=a.children;void 0===b?(this.data=d.extend(this.data,a),this.render()):(a=d.extend({},a),a.children=void 0,this.data=d.extend(this.data,a),this.removeChildren(),this.addChild(b))},_getInnerHtml:function(){var a=this.tree,b=a.options,c=a.cache,e=this.getLevel(),f=this.data,d="";e<b.minExpandLevel?1<e&&(d+=c.tagConnector):d=!1!==this.hasChildren()?
d+c.tagExpander:d+c.tagConnector;b.checkbox&&(!0!==f.hideCheckbox&&!f.isStatusNode)&&(d+=c.tagCheckbox);f.icon?(c="/"===f.icon.charAt(0)?f.icon:b.imagePath+f.icon,d+="<img src='"+c+"' alt='' />"):!1!==f.icon&&(d=f.iconClass?d+("<span class=' "+f.iconClass+"'></span>"):d+c.tagNodeIcon);c="";b.onCustomRender&&(c=b.onCustomRender.call(a,this)||"");c||(a=f.tooltip?' title="'+f.tooltip.replace(/\"/g,"&quot;")+'"':"",c=f.href||"#",c=b.noLink||f.noLink?'<span style="display:inline-block;" class="'+b.classNames.title+
'"'+a+">"+f.title+"</span>":'<a href="'+c+'" class="'+b.classNames.title+'"'+a+">"+f.title+"</a>");return d+c},_fixOrder:function(){var a=this.childList;if(a&&this.ul)for(var b=this.ul.firstChild,c=0,e=a.length-1;c<e;c++){var f=a[c],d=b.dtnode;f!==d?(this.tree.logDebug("_fixOrder: mismatch at index "+c+": "+f+" != "+d),this.ul.insertBefore(f.li,d.li)):b=b.nextSibling}},render:function(a,b){var c=this.tree,e=this.parent,f=this.data,g=c.options,h=g.classNames,k=this.isLastSibling(),l=!1;if(!e&&!this.ul)this.li=
this.span=null,this.ul=document.createElement("ul"),this.ul.className=1<g.minExpandLevel?h.container+" "+h.noConnector:h.container;else if(e){this.li||(l=!0,this.li=document.createElement("li"),this.li.dtnode=this,f.key&&g.generateIds&&(this.li.id=g.idPrefix+f.key),this.span=document.createElement("span"),this.span.className=h.title,this.li.appendChild(this.span),e.ul||(e.ul=document.createElement("ul"),e.ul.style.display="none",e.li.appendChild(e.ul)),e.ul.appendChild(this.li));this.span.innerHTML=
this._getInnerHtml();var n=[];n.push(h.node);f.isFolder&&n.push(h.folder);this.bExpanded&&n.push(h.expanded);!1!==this.hasChildren()&&n.push(h.hasChildren);f.isLazy&&null===this.childList&&n.push(h.lazy);k&&n.push(h.lastsib);this.bSelected&&n.push(h.selected);this.hasSubSel&&n.push(h.partsel);c.activeNode===this&&n.push(h.active);f.addClass&&n.push(f.addClass);n.push(h.combinedExpanderPrefix+(this.bExpanded?"e":"c")+(f.isLazy&&null===this.childList?"d":"")+(k?"l":""));n.push(h.combinedIconPrefix+
(this.bExpanded?"e":"c")+(f.isFolder?"f":""));this.span.className=n.join(" ");this.li.className=k?h.lastsib:"";l&&g.onCreate&&g.onCreate.call(c,this,this.span);g.onRender&&g.onRender.call(c,this,this.span)}if((this.bExpanded||!0===b)&&this.childList){c=0;for(f=this.childList.length;c<f;c++)this.childList[c].render(!1,b);this._fixOrder()}this.ul&&(c="none"===this.ul.style.display,f=!!this.bExpanded,a&&g.fx&&c===f?(e=g.fx.duration||200,d(this.ul).animate(g.fx,e)):this.ul.style.display=this.bExpanded||
!e?"":"none")},getKeyPath:function(a){var b=[];this.visitParents(function(a){a.parent&&b.unshift(a.data.key)},!a);return"/"+b.join(this.tree.options.keyPathSeparator)},getParent:function(){return this.parent},getChildren:function(){return void 0===this.hasChildren()?void 0:this.childList},hasChildren:function(){return this.data.isLazy?null===this.childList||void 0===this.childList?void 0:0===this.childList.length?!1:1===this.childList.length&&this.childList[0].isStatusNode()?void 0:!0:!!this.childList},
isFirstSibling:function(){var a=this.parent;return!a||a.childList[0]===this},isLastSibling:function(){var a=this.parent;return!a||a.childList[a.childList.length-1]===this},isLoading:function(){return!!this._isLoading},getPrevSibling:function(){if(!this.parent)return null;for(var a=this.parent.childList,b=1,c=a.length;b<c;b++)if(a[b]===this)return a[b-1];return null},getNextSibling:function(){if(!this.parent)return null;for(var a=this.parent.childList,b=0,c=a.length-1;b<c;b++)if(a[b]===this)return a[b+
1];return null},isStatusNode:function(){return!0===this.data.isStatusNode},isChildOf:function(a){return this.parent&&this.parent===a},isDescendantOf:function(a){if(!a)return!1;for(var b=this.parent;b;){if(b===a)return!0;b=b.parent}return!1},countChildren:function(){var a=this.childList;if(!a)return 0;for(var b=a.length,c=0,e=b;c<e;c++)b+=a[c].countChildren();return b},sortChildren:function(a,b){var c=this.childList;if(c){a=a||function(a,b){var c=a.data.title.toLowerCase(),e=b.data.title.toLowerCase();
return c===e?0:c>e?1:-1};c.sort(a);if(b)for(var e=0,f=c.length;e<f;e++)c[e].childList&&c[e].sortChildren(a,"$norender$");"$norender$"!==b&&this.render()}},_setStatusNode:function(a){var b=this.childList?this.childList[0]:null;if(a)b?(a.isStatusNode=!0,a.key="_statusNode",b.data=a,b.render()):(a.isStatusNode=!0,a.key="_statusNode",this.addChild(a));else if(b&&b.isStatusNode()){try{this.ul&&(this.ul.removeChild(b.li),b.li=null)}catch(c){}1===this.childList.length?this.childList=[]:this.childList.shift()}},
setLazyNodeStatus:function(a,b){var c=b&&b.tooltip?b.tooltip:null,e=b&&b.info?" ("+b.info+")":"";switch(a){case DTNodeStatus_Ok:this._setStatusNode(null);d(this.span).removeClass(this.tree.options.classNames.nodeLoading);this._isLoading=!1;this.tree.options.autoFocus&&(this===this.tree.tnRoot&&this.childList&&0<this.childList.length?this.childList[0].focus():this.focus());break;case DTNodeStatus_Loading:this._isLoading=!0;d(this.span).addClass(this.tree.options.classNames.nodeLoading);this.parent||
this._setStatusNode({title:this.tree.options.strings.loading+e,tooltip:c,addClass:this.tree.options.classNames.nodeWait});break;case DTNodeStatus_Error:this._isLoading=!1;this._setStatusNode({title:this.tree.options.strings.loadError+e,tooltip:c,addClass:this.tree.options.classNames.nodeError});break;default:throw"Bad LazyNodeStatus: '"+a+"'.";}},_parentList:function(a,b){for(var c=[],e=b?this:this.parent;e;)(a||e.parent)&&c.unshift(e),e=e.parent;return c},getLevel:function(){for(var a=0,b=this.parent;b;)a++,
b=b.parent;return a},_getTypeForOuterNodeEvent:function(a){var b=this.tree.options.classNames,c=a.target;if(0>c.className.indexOf(b.node))return null;var e=a.pageX-c.offsetLeft;a=a.pageY-c.offsetTop;for(var f=0,d=c.childNodes.length;f<d;f++){var h=c.childNodes[f],k=h.offsetLeft-c.offsetLeft,l=h.offsetTop-c.offsetTop,n=h.clientWidth,m=h.clientHeight;if(e>=k&&e<=k+n&&a>=l&&a<=l+m){if(h.className==b.title)return"title";if(h.className==b.expander)return"expander";if(h.className==b.checkbox)return"checkbox";
if(h.className==b.nodeIcon)return"icon"}}return"prefix"},getEventTargetType:function(a){var b=a&&a.target?a.target.className:"",c=this.tree.options.classNames;return b===c.title?"title":b===c.expander?"expander":b===c.checkbox?"checkbox":b===c.nodeIcon?"icon":b===c.empty||b===c.vline||b===c.connector?"prefix":0<=b.indexOf(c.node)?this._getTypeForOuterNodeEvent(a):null},isVisible:function(){for(var a=this._parentList(!0,!1),b=0,c=a.length;b<c;b++)if(!a[b].bExpanded)return!1;return!0},makeVisible:function(){for(var a=
this._parentList(!0,!1),b=0,c=a.length;b<c;b++)a[b]._expand(!0)},focus:function(){this.makeVisible();try{d(this.span).find(">a").focus()}catch(a){}},isFocused:function(){return this.tree.tnFocused===this},_activate:function(a,b){this.tree.logDebug("dtnode._activate(%o, fireEvents=%o) - %o",a,b,this);var c=this.tree.options;if(!(this.data.isStatusNode||b&&c.onQueryActivate&&!1===c.onQueryActivate.call(this.tree,a,this)))if(a){if(this.tree.activeNode){if(this.tree.activeNode===this)return;this.tree.activeNode.deactivate()}c.activeVisible&&
this.makeVisible();this.tree.activeNode=this;c.persist&&d.cookie(c.cookieId+"-active",this.data.key,c.cookie);this.tree.persistence.activeKey=this.data.key;d(this.span).addClass(c.classNames.active);b&&c.onActivate&&c.onActivate.call(this.tree,this)}else this.tree.activeNode!==this||c.onQueryActivate&&!1===c.onQueryActivate.call(this.tree,!1,this)||(d(this.span).removeClass(c.classNames.active),c.persist&&d.cookie(c.cookieId+"-active","",c.cookie),this.tree.persistence.activeKey=null,this.tree.activeNode=
null,b&&c.onDeactivate&&c.onDeactivate.call(this.tree,this))},activate:function(){this._activate(!0,!0)},activateSilently:function(){this._activate(!0,!1)},deactivate:function(){this._activate(!1,!0)},isActive:function(){return this.tree.activeNode===this},_userActivate:function(){var a=!0,b=!1;if(this.data.isFolder)switch(this.tree.options.clickFolderMode){case 2:a=!1;b=!0;break;case 3:a=b=!0}null===this.parent&&(b=!1);b&&(this.toggleExpand(),this.focus());a&&this.activate()},_setSubSel:function(a){a?
(this.hasSubSel=!0,d(this.span).addClass(this.tree.options.classNames.partsel)):(this.hasSubSel=!1,d(this.span).removeClass(this.tree.options.classNames.partsel))},_updatePartSelectionState:function(){var a;if(!this.hasChildren())return a=this.bSelected&&!this.data.unselectable&&!this.data.isStatusNode,this._setSubSel(!1),a;var b,c=this.childList,e=!0,f=!0;a=0;for(b=c.length;a<b;a++){var d=c[a]._updatePartSelectionState();!1!==d&&(f=!1);!0!==d&&(e=!1)}a=e?!0:f?!1:void 0;this._setSubSel(void 0===a);
this.bSelected=!0===a;return a},_fixSelectionState:function(){var a,b,c;if(this.bSelected){if(this.visit(function(a){a.parent._setSubSel(!0);a.data.unselectable||a._select(!0,!1,!1)}),!this.tree.options.ignoreSelectionParent)for(a=this.parent;a;){a._setSubSel(!0);var e=!0;b=0;for(c=a.childList.length;b<c;b++){var f=a.childList[b];if(!f.bSelected&&!f.data.isStatusNode&&!f.data.unselectable){e=!1;break}}e&&a._select(!0,!1,!1);a=a.parent}}else if(this._setSubSel(!1),this.visit(function(a){a._setSubSel(!1);
a._select(!1,!1,!1)}),!this.tree.options.ignoreSelectionParent)for(a=this.parent;a;){a._select(!1,!1,!1);e=!1;b=0;for(c=a.childList.length;b<c;b++)if(a.childList[b].bSelected||a.childList[b].hasSubSel){e=!0;break}a._setSubSel(e);a=a.parent}},_select:function(a,b,c){var e=this.tree.options;this.data.isStatusNode||(this.bSelected===a||b&&e.onQuerySelect&&!1===e.onQuerySelect.call(this.tree,a,this))||(1==e.selectMode&&a&&this.tree.visit(function(a){if(a.bSelected)return a._select(!1,!1,!1),!1}),(this.bSelected=
a)?(e.persist&&this.tree.persistence.addSelect(this.data.key),d(this.span).addClass(e.classNames.selected),c&&3===e.selectMode&&this._fixSelectionState(),b&&e.onSelect&&e.onSelect.call(this.tree,!0,this)):(e.persist&&this.tree.persistence.clearSelect(this.data.key),d(this.span).removeClass(e.classNames.selected),c&&3===e.selectMode&&this._fixSelectionState(),b&&e.onSelect&&e.onSelect.call(this.tree,!1,this)))},select:function(a){return this.data.unselectable?this.bSelected:this._select(!1!==a,!0,
!0)},toggleSelect:function(){return this.select(!this.bSelected)},isSelected:function(){return this.bSelected},isLazy:function(){return!!this.data.isLazy},_loadContent:function(){try{var a=this.tree.options;this.tree.logDebug("_loadContent: start - %o",this);this.setLazyNodeStatus(DTNodeStatus_Loading);!0===a.onLazyRead.call(this.tree,this)&&(this.setLazyNodeStatus(DTNodeStatus_Ok),this.tree.logDebug("_loadContent: succeeded - %o",this))}catch(b){this.tree.logWarning("_loadContent: failed - %o",b),
this.setLazyNodeStatus(DTNodeStatus_Error,{tooltip:""+b})}},_expand:function(a,b){if(this.bExpanded===a)this.tree.logDebug("dtnode._expand(%o) IGNORED - %o",a,this);else{this.tree.logDebug("dtnode._expand(%o) - %o",a,this);var c=this.tree.options;if(!a&&this.getLevel()<c.minExpandLevel)this.tree.logDebug("dtnode._expand(%o) prevented collapse - %o",a,this);else if(!c.onQueryExpand||!1!==c.onQueryExpand.call(this.tree,a,this)){this.bExpanded=a;c.persist&&(a?this.tree.persistence.addExpand(this.data.key):
this.tree.persistence.clearExpand(this.data.key));this.render(!(this.data.isLazy&&null===this.childList)&&!this._isLoading&&!b);if(this.bExpanded&&this.parent&&c.autoCollapse)for(var e=this._parentList(!1,!0),f=0,d=e.length;f<d;f++)e[f].collapseSiblings();c.activeVisible&&(this.tree.activeNode&&!this.tree.activeNode.isVisible())&&this.tree.activeNode.deactivate();a&&this.data.isLazy&&null===this.childList&&!this._isLoading?this._loadContent():c.onExpand&&c.onExpand.call(this.tree,a,this)}}},isExpanded:function(){return this.bExpanded},
expand:function(a){a=!1!==a;!this.childList&&!this.data.isLazy&&a||null===this.parent&&!a||this._expand(a)},scheduleAction:function(a,b){this.tree.timer&&(clearTimeout(this.tree.timer),this.tree.logDebug("clearTimeout(%o)",this.tree.timer));var c=this;switch(a){case "cancel":break;case "expand":this.tree.timer=setTimeout(function(){c.tree.logDebug("setTimeout: trigger expand");c.expand(!0)},b);break;case "activate":this.tree.timer=setTimeout(function(){c.tree.logDebug("setTimeout: trigger activate");
c.activate()},b);break;default:throw"Invalid mode "+a;}this.tree.logDebug("setTimeout(%s, %s): %s",a,b,this.tree.timer)},toggleExpand:function(){this.expand(!this.bExpanded)},collapseSiblings:function(){if(null!==this.parent)for(var a=this.parent.childList,b=0,c=a.length;b<c;b++)a[b]!==this&&a[b].bExpanded&&a[b]._expand(!1)},_onClick:function(a){var b=this.getEventTargetType(a);if("expander"===b)this.toggleExpand(),this.focus();else if("checkbox"===b)this.toggleSelect(),this.focus();else if(this._userActivate(),
b=this.span.getElementsByTagName("a"),b[0])BROWSER.msie&&9>parseInt(BROWSER.version,10)||b[0].focus();else return!0;a.preventDefault()},_onDblClick:function(a){},_onKeydown:function(a){var b=!0,c;switch(a.which){case 107:case 187:this.bExpanded||this.toggleExpand();break;case 109:case 189:this.bExpanded&&this.toggleExpand();break;case 32:this._userActivate();break;case 8:this.parent&&this.parent.focus();break;case 37:this.bExpanded?(this.toggleExpand(),this.focus()):this.parent&&this.parent.parent&&
this.parent.focus();break;case 39:this.bExpanded||!this.childList&&!this.data.isLazy?this.childList&&this.childList[0].focus():(this.toggleExpand(),this.focus());break;case 38:for(c=this.getPrevSibling();c&&c.bExpanded&&c.childList;)c=c.childList[c.childList.length-1];!c&&(this.parent&&this.parent.parent)&&(c=this.parent);c&&c.focus();break;case 40:if(this.bExpanded&&this.childList)c=this.childList[0];else for(var e=this._parentList(!1,!0),f=e.length-1;0<=f&&!(c=e[f].getNextSibling());f--);c&&c.focus();
break;default:b=!1}b&&a.preventDefault()},_onKeypress:function(a){},_onFocus:function(a){var b=this.tree.options;if("blur"==a.type||"focusout"==a.type)b.onBlur&&b.onBlur.call(this.tree,this),this.tree.tnFocused&&d(this.tree.tnFocused.span).removeClass(b.classNames.focused),this.tree.tnFocused=null,b.persist&&d.cookie(b.cookieId+"-focus","",b.cookie);else if("focus"==a.type||"focusin"==a.type)this.tree.tnFocused&&this.tree.tnFocused!==this&&(this.tree.logDebug("dtnode.onFocus: out of sync: curFocus: %o",
this.tree.tnFocused),d(this.tree.tnFocused.span).removeClass(b.classNames.focused)),this.tree.tnFocused=this,b.onFocus&&b.onFocus.call(this.tree,this),d(this.tree.tnFocused.span).addClass(b.classNames.focused),b.persist&&d.cookie(b.cookieId+"-focus",this.data.key,b.cookie)},visit:function(a,b){var c=!0;if(!0===b&&(c=a(this),!1===c||"skip"==c))return c;if(this.childList)for(var e=0,f=this.childList.length;e<f&&(c=this.childList[e].visit(a,!0),!1!==c);e++);return c},visitParents:function(a,b){if(b&&
!1===a(this))return!1;for(var c=this.parent;c;){if(!1===a(c))return!1;c=c.parent}return!0},remove:function(){if(this===this.tree.root)throw"Cannot remove system root";return this.parent.removeChild(this)},removeChild:function(a){var b=this.childList;if(1==b.length){if(a!==b[0])throw"removeChild: invalid child";return this.removeChildren()}a===this.tree.activeNode&&a.deactivate();this.tree.options.persist&&(a.bSelected&&this.tree.persistence.clearSelect(a.data.key),a.bExpanded&&this.tree.persistence.clearExpand(a.data.key));
a.removeChildren(!0);this.ul&&this.ul.removeChild(a.li);for(var c=0,e=b.length;c<e;c++)if(b[c]===a){this.childList.splice(c,1);break}},removeChildren:function(a,b){this.tree.logDebug("%s.removeChildren(%o)",this,a);var c=this.tree,e=this.childList;if(e){for(var f=0,g=e.length;f<g;f++){var h=e[f];h!==c.activeNode||b||h.deactivate();this.tree.options.persist&&!b&&(h.bSelected&&this.tree.persistence.clearSelect(h.data.key),h.bExpanded&&this.tree.persistence.clearExpand(h.data.key));h.removeChildren(!0,
b);this.ul&&d("li",d(this.ul)).remove()}this.childList=null}a||(this._isLoading=!1,this.render())},setTitle:function(a){this.fromDict({title:a})},reload:function(a){throw"Use reloadChildren() instead";},reloadChildren:function(a){if(null===this.parent)throw"Use tree.reload() instead";if(!this.data.isLazy)throw"node.reloadChildren() requires lazy nodes.";if(a){var b=this,c="nodeLoaded.dynatree."+this.tree.$tree.attr("id")+"."+this.data.key;this.tree.$tree.bind(c,function(e,f,d){b.tree.$tree.unbind(c);
b.tree.logDebug("loaded %o, %o, %o",e,f,d);if(f!==b)throw"got invalid load event";a.call(b.tree,f,d)})}this.removeChildren();this._loadContent()},_loadKeyPath:function(a,b){var c=this.tree;c.logDebug("%s._loadKeyPath(%s)",this,a);if(""===a)throw"Key path must not be empty";var e=a.split(c.options.keyPathSeparator);if(""===e[0])throw"Key path must be relative (don't start with '/')";var f=e.shift();if(this.childList)for(var d=0,h=this.childList.length;d<h;d++){var k=this.childList[d];if(k.data.key===
f){if(0===e.length)b.call(c,k,"ok");else if(!k.data.isLazy||null!==k.childList&&void 0!==k.childList)b.call(c,k,"loaded"),k._loadKeyPath(e.join(c.options.keyPathSeparator),b);else{c.logDebug("%s._loadKeyPath(%s) -> reloading %s...",this,a,k);var l=this;k.reloadChildren(function(d,f){f?(c.logDebug("%s._loadKeyPath(%s) -> reloaded %s.",d,a,d),b.call(c,k,"loaded"),d._loadKeyPath(e.join(c.options.keyPathSeparator),b)):(c.logWarning("%s._loadKeyPath(%s) -> reloadChildren() failed.",l,a),b.call(c,k,"error"))})}return}}b.call(c,
void 0,"notfound",f,0===e.length);c.logWarning("Node not found: "+f)},resetLazy:function(){if(null===this.parent)throw"Use tree.reload() instead";if(!this.data.isLazy)throw"node.resetLazy() requires lazy nodes.";this.expand(!1);this.removeChildren()},_addChildNode:function(a,b){var c=this.tree,e=c.options,f=c.persistence;a.parent=this;null===this.childList?this.childList=[]:b||0<this.childList.length&&d(this.childList[this.childList.length-1].span).removeClass(e.classNames.lastsib);if(b){var g=d.inArray(b,
this.childList);if(0>g)throw"<beforeNode> must be a child of <this>";this.childList.splice(g,0,a)}else this.childList.push(a);g=c.isInitializing();e.persist&&f.cookiesFound&&g?(f.activeKey===a.data.key&&(c.activeNode=a),f.focusedKey===a.data.key&&(c.focusNode=a),a.bExpanded=0<=d.inArray(a.data.key,f.expandedKeyList),a.bSelected=0<=d.inArray(a.data.key,f.selectedKeyList)):(a.data.activate&&(c.activeNode=a,e.persist&&(f.activeKey=a.data.key)),a.data.focus&&(c.focusNode=a,e.persist&&(f.focusedKey=a.data.key)),
a.bExpanded=!0===a.data.expand,a.bExpanded&&e.persist&&f.addExpand(a.data.key),a.bSelected=!0===a.data.select,a.bSelected&&e.persist&&f.addSelect(a.data.key));e.minExpandLevel>=a.getLevel()&&(this.bExpanded=!0);if(a.bSelected&&3==e.selectMode)for(e=this;e;)e.hasSubSel||e._setSubSel(!0),e=e.parent;c.bEnableUpdate&&this.render();return a},addChild:function(a,b){if("string"==typeof a)throw"Invalid data type for "+a;if(a&&0!==a.length){if(a instanceof r)return this._addChildNode(a,b);a.length||(a=[a]);
for(var c=this.tree.enableUpdate(!1),e=null,d=0,g=a.length;d<g;d++){var h=a[d],k=this._addChildNode(new r(this,this.tree,h),b);e||(e=k);h.children&&k.addChild(h.children,null)}this.tree.enableUpdate(c);return e}},append:function(a){this.tree.logWarning("node.append() is deprecated (use node.addChild() instead).");return this.addChild(a,null)},appendAjax:function(a){var b=this;this.removeChildren(!1,!0);this.setLazyNodeStatus(DTNodeStatus_Loading);if(a.debugLazyDelay){var c=a.debugLazyDelay;a.debugLazyDelay=
0;this.tree.logInfo("appendAjax: waiting for debugLazyDelay "+c);setTimeout(function(){b.appendAjax(a)},c)}else{var e=a.success,f=a.error,g="nodeLoaded.dynatree."+this.tree.$tree.attr("id")+"."+this.data.key,h=d.extend({},this.tree.options.ajaxDefaults,a,{success:function(a,c,f){f=b.tree.phase;b.tree.phase="init";h.postProcess?a=h.postProcess.call(this,a,this.dataType):a&&a.hasOwnProperty("d")&&(a="string"==typeof a.d?d.parseJSON(a.d):a.d);d.isArray(a)&&0===a.length||b.addChild(a,null);b.tree.phase=
"postInit";e&&e.call(h,b,a,c);b.tree.logDebug("trigger "+g);b.tree.$tree.trigger(g,[b,!0]);b.tree.phase=f;b.setLazyNodeStatus(DTNodeStatus_Ok);d.isArray(a)&&0===a.length&&(b.childList=[],b.render())},error:function(a,c,e){b.tree.logWarning("appendAjax failed:",c,":\n",a,"\n",e);f&&f.call(h,b,a,c,e);b.tree.$tree.trigger(g,[b,!1]);b.setLazyNodeStatus(DTNodeStatus_Error,{info:c,tooltip:""+e})}});d.ajax(h)}},move:function(a,b){var c;if(this!==a){if(!this.parent)throw"Cannot move system root";if(void 0===
b||"over"==b)b="child";var e=this.parent,f="child"===b?a:a.parent;if(f.isDescendantOf(this))throw"Cannot move a node to it's own descendant";if(1==this.parent.childList.length)this.parent.childList=this.parent.data.isLazy?[]:null,this.parent.bExpanded=!1;else{c=d.inArray(this,this.parent.childList);if(0>c)throw"Internal error";this.parent.childList.splice(c,1)}this.parent.ul&&this.parent.ul.removeChild(this.li);this.parent=f;if(f.hasChildren())switch(b){case "child":f.childList.push(this);break;case "before":c=
d.inArray(a,f.childList);if(0>c)throw"Internal error";f.childList.splice(c,0,this);break;case "after":c=d.inArray(a,f.childList);if(0>c)throw"Internal error";f.childList.splice(c+1,0,this);break;default:throw"Invalid mode "+b;}else f.childList=[this];f.ul||(f.ul=document.createElement("ul"),f.ul.style.display="none",f.li.appendChild(f.ul));this.li&&f.ul.appendChild(this.li);if(this.tree!==a.tree)throw this.visit(function(b){b.tree=a.tree},null,!0),"Not yet implemented.";e.isDescendantOf(f)||e.render();
f.isDescendantOf(e)||f.render()}},lastentry:void 0};var s=q.create();s._getTreePersistData=function(a,b){var c=new s(a,b);c.read();return c.toDict()};getDynaTreePersistData=s._getTreePersistData;s.prototype={initialize:function(a,b){void 0===a&&(a=d.ui.dynatree.prototype.options.cookieId);b=d.extend({},d.ui.dynatree.prototype.options.cookie,b);this.cookieId=a;this.cookieOpts=b;this.cookiesFound=void 0;this.selectedKeyList=this.expandedKeyList=this.focusedKey=this.activeKey=null},_log:function(a){Array.prototype.unshift.apply(arguments,
["debug"]);_log.apply(this,arguments)},read:function(){this.cookiesFound=!1;var a=d.cookie(this.cookieId+"-active");this.activeKey=null===a?"":a;null!==a&&(this.cookiesFound=!0);a=d.cookie(this.cookieId+"-focus");this.focusedKey=null===a?"":a;null!==a&&(this.cookiesFound=!0);a=d.cookie(this.cookieId+"-expand");this.expandedKeyList=null===a?[]:a.split(",");null!==a&&(this.cookiesFound=!0);a=d.cookie(this.cookieId+"-select");this.selectedKeyList=null===a?[]:a.split(",");null!==a&&(this.cookiesFound=
!0)},write:function(){d.cookie(this.cookieId+"-active",null===this.activeKey?"":this.activeKey,this.cookieOpts);d.cookie(this.cookieId+"-focus",null===this.focusedKey?"":this.focusedKey,this.cookieOpts);d.cookie(this.cookieId+"-expand",null===this.expandedKeyList?"":this.expandedKeyList.join(","),this.cookieOpts);d.cookie(this.cookieId+"-select",null===this.selectedKeyList?"":this.selectedKeyList.join(","),this.cookieOpts)},addExpand:function(a){0>d.inArray(a,this.expandedKeyList)&&(this.expandedKeyList.push(a),
d.cookie(this.cookieId+"-expand",this.expandedKeyList.join(","),this.cookieOpts))},clearExpand:function(a){a=d.inArray(a,this.expandedKeyList);0<=a&&(this.expandedKeyList.splice(a,1),d.cookie(this.cookieId+"-expand",this.expandedKeyList.join(","),this.cookieOpts))},addSelect:function(a){0>d.inArray(a,this.selectedKeyList)&&(this.selectedKeyList.push(a),d.cookie(this.cookieId+"-select",this.selectedKeyList.join(","),this.cookieOpts))},clearSelect:function(a){a=d.inArray(a,this.selectedKeyList);0<=
a&&(this.selectedKeyList.splice(a,1),d.cookie(this.cookieId+"-select",this.selectedKeyList.join(","),this.cookieOpts))},isReloading:function(){return!0===this.cookiesFound},toDict:function(){return{cookiesFound:this.cookiesFound,activeKey:this.activeKey,focusedKey:this.activeKey,expandedKeyList:this.expandedKeyList,selectedKeyList:this.selectedKeyList}},lastentry:void 0};var t=q.create();t.version="$Version:$";t.prototype={initialize:function(a){this.phase="init";this.$widget=a;this.options=a.options;
this.$tree=a.element;this.timer=null;this.divTree=this.$tree.get(0);m(this)},_load:function(a){var b=this.options,c=this;this.bEnableUpdate=!0;this._nodeCount=1;this.focusNode=this.activeNode=null;void 0!==b.rootVisible&&this.logWarning("Option 'rootVisible' is no longer supported.");1>b.minExpandLevel&&(this.logWarning("Option 'minExpandLevel' must be >= 1."),b.minExpandLevel=1);b.classNames!==d.ui.dynatree.prototype.options.classNames&&(b.classNames=d.extend({},d.ui.dynatree.prototype.options.classNames,
b.classNames));b.ajaxDefaults!==d.ui.dynatree.prototype.options.ajaxDefaults&&(b.ajaxDefaults=d.extend({},d.ui.dynatree.prototype.options.ajaxDefaults,b.ajaxDefaults));b.dnd!==d.ui.dynatree.prototype.options.dnd&&(b.dnd=d.extend({},d.ui.dynatree.prototype.options.dnd,b.dnd));b.imagePath||d("script").each(function(){if(0<=this.src.search(/.*dynatree[^\/]*\.js$/i))return 0<=this.src.indexOf("/")?b.imagePath=this.src.slice(0,this.src.lastIndexOf("/"))+"/skin/":b.imagePath="skin/",c.logDebug("Guessing imagePath from '%s': '%s'",
this.src,b.imagePath),!1});this.persistence=new s(b.cookieId,b.cookie);b.persist&&(d.cookie||_log("warn","Please include jquery.cookie.js to use persistence."),this.persistence.read());this.logDebug("DynaTree.persistence: %o",this.persistence.toDict());this.cache={tagEmpty:"<span class='"+b.classNames.empty+"'></span>",tagVline:"<span class='"+b.classNames.vline+"'></span>",tagExpander:"<span class='"+b.classNames.expander+"'></span>",tagConnector:"<span class='"+b.classNames.connector+"'></span>",
tagNodeIcon:"<span class='"+b.classNames.nodeIcon+"'></span>",tagCheckbox:"<span class='"+b.classNames.checkbox+"'></span>",lastentry:void 0};(b.children||b.initAjax&&b.initAjax.url||b.initId)&&d(this.divTree).empty();var e=this.$tree.find(">ul:first").hide();this.tnRoot=new r(null,this,{});this.tnRoot.bExpanded=!0;this.tnRoot.render();this.divTree.appendChild(this.tnRoot.ul);var f=this.tnRoot,g=b.persist&&this.persistence.isReloading(),h=!1,k=this.enableUpdate(!1);this.logDebug("Dynatree._load(): read tree structure...");
b.children?f.addChild(b.children):b.initAjax&&b.initAjax.url?(h=!0,f.data.isLazy=!0,this._reloadAjax(a)):b.initId?this._createFromTag(f,d("#"+b.initId)):(this._createFromTag(f,e),e.remove());this._checkConsistency();h||3!=b.selectMode||f._updatePartSelectionState();this.logDebug("Dynatree._load(): render nodes...");this.enableUpdate(k);this.logDebug("Dynatree._load(): bind events...");this.$widget.bind();this.logDebug("Dynatree._load(): postInit...");this.phase="postInit";b.persist&&this.persistence.write();
this.focusNode&&this.focusNode.isVisible()&&(this.logDebug("Focus on init: %o",this.focusNode),this.focusNode.focus());h||(b.onPostInit&&b.onPostInit.call(this,g,!1),a&&a.call(this,"ok"));this.phase="idle"},_reloadAjax:function(a){var b=this.options;if(!b.initAjax||!b.initAjax.url)throw"tree.reload() requires 'initAjax' mode.";var c=this.persistence,e=d.extend({},b.initAjax);e.addActiveKey&&(e.data.activeKey=c.activeKey);e.addFocusedKey&&(e.data.focusedKey=c.focusedKey);e.addExpandedKeyList&&(e.data.expandedKeyList=
c.expandedKeyList.join(","));e.addSelectedKeyList&&(e.data.selectedKeyList=c.selectedKeyList.join(","));e.success&&this.logWarning("initAjax: success callback is ignored; use onPostInit instead.");e.error&&this.logWarning("initAjax: error callback is ignored; use onPostInit instead.");var f=c.isReloading();e.success=function(c,e,d){3==b.selectMode&&c.tree.tnRoot._updatePartSelectionState();b.onPostInit&&b.onPostInit.call(c.tree,f,!1);a&&a.call(c.tree,"ok")};e.error=function(c,e,d,l){b.onPostInit&&
b.onPostInit.call(c.tree,f,!0,e,d,l);a&&a.call(c.tree,"error",e,d,l)};this.logDebug("Dynatree._init(): send Ajax request...");this.tnRoot.appendAjax(e)},toString:function(){return"Dynatree '"+this.$tree.attr("id")+"'"},toDict:function(){return this.tnRoot.toDict(!0)},serializeArray:function(a){a=this.getSelectedNodes(a);for(var b=this.$tree.attr("name")||this.$tree.attr("id"),c=[],e=0,d=a.length;e<d;e++)c.push({name:b,value:a[e].data.key});return c},getPersistData:function(){return this.persistence.toDict()},
logDebug:function(a){2<=this.options.debugLevel&&(Array.prototype.unshift.apply(arguments,["debug"]),_log.apply(this,arguments))},logInfo:function(a){1<=this.options.debugLevel&&(Array.prototype.unshift.apply(arguments,["info"]),_log.apply(this,arguments))},logWarning:function(a){Array.prototype.unshift.apply(arguments,["warn"]);_log.apply(this,arguments)},isInitializing:function(){return"init"==this.phase||"postInit"==this.phase},isReloading:function(){return("init"==this.phase||"postInit"==this.phase)&&
this.options.persist&&this.persistence.cookiesFound},isUserEvent:function(){return"userEvent"==this.phase},redraw:function(){this.tnRoot.render(!1,!1)},renderInvisibleNodes:function(){this.tnRoot.render(!1,!0)},reload:function(a){this._load(a)},getRoot:function(){return this.tnRoot},enable:function(){this.$widget.enable()},disable:function(){this.$widget.disable()},getNodeByKey:function(a){var b=document.getElementById(this.options.idPrefix+a);if(b)return b.dtnode?b.dtnode:null;var c=null;this.visit(function(b){if(b.data.key===
a)return c=b,!1},!0);return c},getActiveNode:function(){return this.activeNode},reactivate:function(a){var b=this.activeNode;b&&(this.activeNode=null,b.activate(),a&&b.focus())},getSelectedNodes:function(a){var b=[];this.tnRoot.visit(function(c){if(c.bSelected&&(b.push(c),!0===a))return"skip"});return b},activateKey:function(a){a=null===a?null:this.getNodeByKey(a);if(!a)return this.activeNode&&this.activeNode.deactivate(),this.activeNode=null;a.focus();a.activate();return a},loadKeyPath:function(a,
b){var c=a.split(this.options.keyPathSeparator);""===c[0]&&c.shift();c[0]==this.tnRoot.data.key&&(this.logDebug("Removed leading root key."),c.shift());a=c.join(this.options.keyPathSeparator);return this.tnRoot._loadKeyPath(a,b)},selectKey:function(a,b){var c=this.getNodeByKey(a);if(!c)return null;c.select(b);return c},enableUpdate:function(a){if(this.bEnableUpdate==a)return a;(this.bEnableUpdate=a)&&this.redraw();return!a},count:function(){return this.tnRoot.countChildren()},visit:function(a,b){return this.tnRoot.visit(a,
b)},_createFromTag:function(a,b){var c=this;b.find(">li").each(function(){var b=d(this),f=b.find(">span:first"),g=b.find(">a:first"),h=null,k=null,l;f.length?f=f.html():g.length?(f=g.html(),h=g.attr("href"),k=g.attr("target"),l=g.attr("title")):(f=b.html(),g=f.search(/<ul/i),f=0<=g?d.trim(f.substring(0,g)):d.trim(f));l={title:f,tooltip:l,isFolder:b.hasClass("folder"),isLazy:b.hasClass("lazy"),expand:b.hasClass("expanded"),select:b.hasClass("selected"),activate:b.hasClass("active"),focus:b.hasClass("focused"),
noLink:b.hasClass("noLink")};h&&(l.href=h,l.target=k);b.attr("title")&&(l.tooltip=b.attr("title"));b.attr("id")&&(l.key=""+b.attr("id"));if(b.attr("data")&&(h=d.trim(b.attr("data")))){"{"!=h.charAt(0)&&(h="{"+h+"}");try{d.extend(l,eval("("+h+")"))}catch(m){throw"Error parsing node data: "+m+"\ndata:\n'"+h+"'";}}h=a.addChild(l);b=b.find(">ul:first");b.length&&c._createFromTag(h,b)})},_checkConsistency:function(){},_setDndStatus:function(a,b,c,e,f){a=a?d(a.span):null;b=d(b.span);this.$dndMarker||(this.$dndMarker=
d("<div id='dynatree-drop-marker'></div>").hide().css({"z-index":1E3}).prependTo(d(this.divTree).parent()));if("after"===e||"before"===e||"over"===e){var g="0 0";switch(e){case "before":this.$dndMarker.removeClass("dynatree-drop-after dynatree-drop-over");this.$dndMarker.addClass("dynatree-drop-before");g="0 -8";break;case "after":this.$dndMarker.removeClass("dynatree-drop-before dynatree-drop-over");this.$dndMarker.addClass("dynatree-drop-after");g="0 8";break;default:this.$dndMarker.removeClass("dynatree-drop-after dynatree-drop-before"),
this.$dndMarker.addClass("dynatree-drop-over"),b.addClass("dynatree-drop-target"),g="8 0"}this.$dndMarker.show().position({my:"left top",at:"left top",of:b,offset:g})}else b.removeClass("dynatree-drop-target"),this.$dndMarker.hide();"after"===e?b.addClass("dynatree-drop-after"):b.removeClass("dynatree-drop-after");"before"===e?b.addClass("dynatree-drop-before"):b.removeClass("dynatree-drop-before");!0===f?(a&&a.addClass("dynatree-drop-accept"),b.addClass("dynatree-drop-accept"),c.addClass("dynatree-drop-accept")):
(a&&a.removeClass("dynatree-drop-accept"),b.removeClass("dynatree-drop-accept"),c.removeClass("dynatree-drop-accept"));!1===f?(a&&a.addClass("dynatree-drop-reject"),b.addClass("dynatree-drop-reject"),c.addClass("dynatree-drop-reject")):(a&&a.removeClass("dynatree-drop-reject"),b.removeClass("dynatree-drop-reject"),c.removeClass("dynatree-drop-reject"))},_onDragEvent:function(a,b,c,e,f,g){var h=this.options.dnd,k=null,l=d(b.span);switch(a){case "helper":c=d("<div class='dynatree-drag-helper'><span class='dynatree-drag-helper-img' /></div>").append(d(e.target).closest(".dynatree-title").clone());
d("ul.dynatree-container",b.tree.divTree).append(c);c.data("dtSourceNode",b);k=c;break;case "start":b.isStatusNode()?k=!1:h.onDragStart&&(k=h.onDragStart(b));!1===k?(this.logDebug("tree.onDragStart() cancelled"),f.helper.trigger("mouseup"),f.helper.hide()):l.addClass("dynatree-drag-source");break;case "enter":k=(k=h.onDragEnter?h.onDragEnter(b,c):null)?{over:!0===k||"over"===k||0<=d.inArray("over",k),before:!0===k||"before"===k||0<=d.inArray("before",k),after:!0===k||"after"===k||0<=d.inArray("after",
k)}:!1;f.helper.data("enterResponse",k);break;case "over":g=f.helper.data("enterResponse");a=null;if(!1!==g)if("string"===typeof g)a=g;else{var m=l.offset();e=e.pageY-m.top;l.width();l=e/l.height();g.after&&0.75<l?a="after":!g.over&&g.after&&0.5<l?a="after":g.before&&0.25>=l?a="before":!g.over&&g.before&&0.5>=l?a="before":g.over&&(a="over");h.preventVoidMoves&&(b===c?a=null:"before"===a&&c&&b===c.getNextSibling()?a=null:"after"===a&&c&&b===c.getPrevSibling()?a=null:"over"===a&&(c&&c.parent===b&&c.isLastSibling())&&
(a=null));f.helper.data("hitMode",a)}"over"===a&&(h.autoExpandMS&&!1!==b.hasChildren()&&!b.bExpanded)&&b.scheduleAction("expand",h.autoExpandMS);a&&h.onDragOver&&(k=h.onDragOver(b,c,a),"over"===k||"before"===k||"after"===k)&&(a=k);this._setDndStatus(c,b,f.helper,a,!1!==k&&null!==a);break;case "drop":l=f.helper.hasClass("dynatree-drop-reject");if((a=f.helper.data("hitMode"))&&h.onDrop&&!l)h.onDrop(b,c,a,f,g);break;case "leave":b.scheduleAction("cancel");f.helper.data("enterResponse",null);f.helper.data("hitMode",
null);this._setDndStatus(c,b,f.helper,"out",void 0);if(h.onDragLeave)h.onDragLeave(b,c);break;case "stop":l.removeClass("dynatree-drag-source");if(h.onDragStop)h.onDragStop(b);break;default:throw"Unsupported drag event: "+a;}return k},cancelDrag:function(){var a=d.ui.ddmanager.current;a&&a.cancel()},lastentry:void 0};d.widget("ui.dynatree",{_init:function(){if(0>p(d.ui.version,"1.8"))return 0<=this.options.debugLevel&&_log("warn","ui.dynatree._init() was called; you should upgrade to jquery.ui.core.js v1.8 or higher."),
this._create();2<=this.options.debugLevel&&_log("debug","ui.dynatree._init() was called; no current default functionality.")},_create:function(){1<=this.options.debugLevel&&logMsg("Dynatree._create(): version='%s', debugLevel=%o.",d.ui.dynatree.version,this.options.debugLevel);this.options.event+=".dynatree";this.element.get(0);this.tree=new t(this);this.tree._load();this.tree.logDebug("Dynatree._init(): done.")},bind:function(){function a(a){a=d.event.fix(a||window.event);var b=d.ui.dynatree.getNode(a.target);
return b?b._onFocus(a):!1}this.unbind();var b="click.dynatree dblclick.dynatree";this.options.keyboard&&(b+=" keypress.dynatree keydown.dynatree");this.element.bind(b,function(a){var b=d.ui.dynatree.getNode(a.target);if(!b)return!0;var f=b.tree,g=f.options;f.logDebug("event(%s): dtnode: %s",a.type,b);var h=f.phase;f.phase="userEvent";try{switch(a.type){case "click":return g.onClick&&!1===g.onClick.call(f,b,a)?!1:b._onClick(a);case "dblclick":return g.onDblClick&&!1===g.onDblClick.call(f,b,a)?!1:b._onDblClick(a);
case "keydown":return g.onKeydown&&!1===g.onKeydown.call(f,b,a)?!1:b._onKeydown(a);case "keypress":return g.onKeypress&&!1===g.onKeypress.call(f,b,a)?!1:b._onKeypress(a)}}catch(k){f.logWarning("bind(%o): dtnode: %o, error: %o",a,b,k)}finally{f.phase=h}});b=this.tree.divTree;b.addEventListener?(b.addEventListener("focus",a,!0),b.addEventListener("blur",a,!0)):b.onfocusin=b.onfocusout=a},unbind:function(){this.element.unbind(".dynatree")},enable:function(){this.bind();d.Widget.prototype.enable.apply(this,
arguments)},disable:function(){this.unbind();d.Widget.prototype.disable.apply(this,arguments)},getTree:function(){return this.tree},getRoot:function(){return this.tree.getRoot()},getActiveNode:function(){return this.tree.getActiveNode()},getSelectedNodes:function(){return this.tree.getSelectedNodes()},lastentry:void 0});0>p(d.ui.version,"1.8")&&(d.ui.dynatree.getter="getTree getRoot getActiveNode getSelectedNodes");d.ui.dynatree.version="$Version:$";d.ui.dynatree.getNode=function(a){if(a instanceof
r)return a;for(void 0!==a.selector&&(a=a[0]);a;){if(a.dtnode)return a.dtnode;a=a.parentNode}return null};d.ui.dynatree.getPersistData=s._getTreePersistData;d.ui.dynatree.prototype.options={title:"Dynatree",minExpandLevel:1,imagePath:null,children:null,initId:null,initAjax:null,autoFocus:!0,keyboard:!0,persist:!1,autoCollapse:!1,clickFolderMode:3,activeVisible:!0,checkbox:!1,selectMode:2,ignoreSelectionParent:0,fx:null,noLink:!1,onClick:null,onDblClick:null,onKeydown:null,onKeypress:null,onFocus:null,
onBlur:null,onQueryActivate:null,onQuerySelect:null,onQueryExpand:null,onPostInit:null,onActivate:null,onDeactivate:null,onSelect:null,onExpand:null,onLazyRead:null,onCustomRender:null,onCreate:null,onRender:null,postProcess:null,dnd:{onDragStart:null,onDragStop:null,autoExpandMS:1E3,preventVoidMoves:!0,onDragEnter:null,onDragOver:null,onDrop:null,onDragLeave:null},ajaxDefaults:{cache:!1,timeout:0,dataType:"json"},strings:{loading:"Loading&#8230;",loadError:"Load error!"},generateIds:!1,idPrefix:"dynatree-id-",
keyPathSeparator:"/",cookieId:"dynatree",cookie:{expires:null},classNames:{container:"dynatree-container",node:"dynatree-node",folder:"dynatree-folder",empty:"dynatree-empty",vline:"dynatree-vline",expander:"dynatree-expander",connector:"dynatree-connector",checkbox:"dynatree-checkbox",nodeIcon:"dynatree-icon",title:"dynatree-title",noConnector:"dynatree-no-connector",nodeError:"dynatree-statusnode-error",nodeWait:"dynatree-statusnode-wait",hidden:"dynatree-hidden",combinedExpanderPrefix:"dynatree-exp-",
combinedIconPrefix:"dynatree-ico-",nodeLoading:"dynatree-loading",hasChildren:"dynatree-has-children",active:"dynatree-active",selected:"dynatree-selected",expanded:"dynatree-expanded",lazy:"dynatree-lazy",focused:"dynatree-focused",partsel:"dynatree-partsel",lastsib:"dynatree-lastsib"},debugLevel:2,lastentry:void 0};0>p(d.ui.version,"1.8")&&(d.ui.dynatree.defaults=d.ui.dynatree.prototype.options);d.ui.dynatree.nodedatadefaults={title:null,key:null,isFolder:!1,isLazy:!1,tooltip:null,href:null,icon:null,
addClass:null,noLink:!1,activate:!1,focus:!1,expand:!1,select:!1,hideCheckbox:!1,unselectable:!1,children:null,lastentry:void 0};var u=!1,v=function(){u||(d.ui.plugin.add("draggable","connectToDynatree",{start:function(a,b){var c=d(this).data("ui-draggable")||d(this).data("draggable"),e=b.helper.data("dtSourceNode")||null;if(e)return c.offset.click.top=-2,c.offset.click.left=16,e.tree._onDragEvent("start",e,null,a,b,c)},drag:function(a,b){var c=d(this).data("ui-draggable")||d(this).data("draggable"),
e=b.helper.data("dtSourceNode")||null,f=b.helper.data("dtTargetNode")||null,g=d.ui.dynatree.getNode(a.target);a.target&&!g&&0<d(a.target).closest("div.dynatree-drag-helper,#dynatree-drop-marker").length||(b.helper.data("dtTargetNode",g),f&&f!==g&&f.tree._onDragEvent("leave",f,e,a,b,c),g&&g.tree.options.dnd.onDrop&&(g===f?g.tree._onDragEvent("over",g,e,a,b,c):g.tree._onDragEvent("enter",g,e,a,b,c)))},stop:function(a,b){var c=d(this).data("ui-draggable")||d(this).data("draggable"),e=b.helper.data("dtSourceNode")||
null,f=b.helper.data("dtTargetNode")||null,g="mouseup"==a.type&&1==a.which;logMsg("draggable-connectToDynatree.stop: targetNode(from event): %s, dtTargetNode: %s",f,b.helper.data("dtTargetNode"));g||logMsg("Drag was cancelled");f&&(g&&f.tree._onDragEvent("drop",f,e,a,b,c),f.tree._onDragEvent("leave",f,e,a,b,c));e&&e.tree._onDragEvent("stop",e,null,a,b,c)}}),u=!0)}})(jQuery);
